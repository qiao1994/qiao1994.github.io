# 22.饮鸩止渴的提速方法


## 短连接风暴

短连接是指连接到数据库后，执行很少的SQL语句就断开的连接

### 方法一：处理掉那些占着连接但是不工作的线程

有损，优先断开事务外空闲太久的连接，如果这样还不够，再考虑断开事务内空闲太久的连接。

### 方法二：减少连接过程的消耗

使用--skip-grant-tables启动MySQL，让每次连接都跳过权限验证

## 慢查询问题

慢查询出现的主要原因有如下三个，在线下提前做好所有sql语句的测试、扫描行数和慢查询分析，可以有效避免。

### 索引没有设计好

紧急创建索引，先关闭备库的binlog，在备库增加索引，然后执行主备切换。

### 语句没写好

可以使用query_rewrite功能，改写一些常见的问题形式

### MySQL选错索引

加上force index

## QPS突增

QPS突增一般是因为业务突增，或者程序bug导致

* 如果是由全新业务导致的问题，并且db运维规范的话，可以直接关闭新业务的用户
* 使用查询重写功能把相关请求改写成`select 1`




