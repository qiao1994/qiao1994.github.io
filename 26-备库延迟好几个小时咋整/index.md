# 26.备库延迟好几个小时咋整


当主库的压力持续较大时，因为主库是多线程执行的，当备库是单线程执行时，主从延迟会越来越大。

在MySQL5.6以前，备库只能串行执行请求，从5.6开始，陆续有了一些并行复制的策略。

## MySQL备库的并行复制策略

### 按库分发

把请求按照不同的数据库分发给不同的worker执行

### 按表分发

把请求按照不同的表分发给不同的worker执行

### 按行分发

把请求按照不同的行(主键+唯一索引)分发给不同的worker执行

### 按事务id分发

1. 在一组里面一起提交的事务，有一个相同的commit_id，下一组就是commit_id+1；
2. commit_id直接写到binlog里面；
3. 传到备库应用的时候，相同commit_id的事务分发到多个worker执行；
4. 这一组全部执行完成后，coordinator再去取下一批。
