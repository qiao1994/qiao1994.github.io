# 5.复杂度来源：高可用

# 计算高可用
无论在哪台机器上进行计算，同样的算法和输入数据，产出的结果都是一样的；所以将计算从一台机器迁移到另外一台机器，对业务没有影响。

## 复杂度来源(同04中集群复杂度的来源)
* 需要增加一个任务分配器
* 分配器和业务服务器之间需要连接和交互(连接方式、异常处理等)
* 分配算法(轮询、按权重、按负载)

# 存储高可用(难点)
和计算相比，存储有一个本质上的区别：将数据从一台机器搬到另一台机器是有延迟的；导致“数据+逻辑=业务”中的数据不一致。
CAP定理证明了一个系统最多能满足一致性、可用性、分区容错性中的两个。

# 高可用状态决策
* 独裁式(有一个专门的决策者)：当决策者自身故障时，系统瘫痪
* 协商式(主备商量)：当主备连接异常时，如何处理？可能会出现双主、双备、多连接状态不一致问题
* 民主式(选举主机 ZooKeeper)：可能出现脑裂问题，通过系统节点数超过半数才选举主节点可以解决，但是当系统真的只剩下低于半数的节点可用时，系统瘫痪。
